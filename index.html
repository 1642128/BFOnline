<!DOCTYPE html>
<html>
<head>
<title>BFOnline</title>
<style>
  textarea {
    width: 100%;
    height: 200px;
    font-family: monospace;
    padding: 10px;
    border: 1px solid #ccc;
    box-sizing: border-box;
    resize: vertical;
  }
</style>
  <script>
  function brainfuck() {
  var code = document.getElementById("myTextBox");
  code = code.value
  var input = document.getElementById("input");
  input = code.value
  // The memory tape is a large array of zeros
  const memory = new Array(30000).fill(0);
  let pointer = 0; // The data pointer
  let output = '';
  let inputIndex = 0;

  // Pre-process loops to find matching brackets
  const loopMap = {};
  const loopStack = [];
  for (let i = 0; i < code.length; i++) {
    if (code[i] === '[') {
      loopStack.push(i);
    } else if (code[i] === ']') {
      const openBracketPos = loopStack.pop();
      loopMap[openBracketPos] = i;
      loopMap[i] = openBracketPos;
    }
  }

  // Main interpreter loop
  for (let i = 0; i < code.length; i++) {
    const command = code[i];

    switch (command) {
      case '>':
        pointer++;
        break;
      case '<':
        pointer--;
        break;
      case '+':
        memory[pointer]++;
        break;
      case '-':
        memory[pointer]--;
        break;
      case '.':
        output += String.fromCharCode(memory[pointer]);
        break;
      case ',':
        if (inputIndex < input.length) {
          memory[pointer] = input.charCodeAt(inputIndex++);
        } else {
          memory[pointer] = 0;
        }
        break;
      case '[':
        if (memory[pointer] === 0) {
          i = loopMap[i];
        }
        break;
      case ']':
        if (memory[pointer] !== 0) {
          i = loopMap[i];
        }
        break;
    }
  }
  var outputbox = document.getElementById("outputbox");
  outputbox.value = output
}
</script>
</head>
<body>

  <h1>BFOnline</h1>

  <form>
    <label for="codeEditor">Enter your BF code here:</label><br>
    <textarea id="codeEditor" name="codeContent" rows="10" cols="50">++++++++[>++++[>++>+++>+++>+<<<<-]>+>+>->>+[<]<-]>>.>---.+++++++..+++.>>.<-.<.+++.------.--------.>>+.>++.</textarea><br>
    <input type="submit" value="Run Code" onclick="brainfuck()">
  </form>
  <input type="text" id="input">
  <input type="text" id="output">
</body>
</html>
